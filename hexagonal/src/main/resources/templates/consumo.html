<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Nutrición inteligente, decisiones saludables</title>
</head>
<body>
    <div id="navbar-container">
        <!-- Este se actualizará con JavaScript después del login -->
    </div>
    <h2>Registrar Consumo</h2>

    <form action="http://localhost:8080/apinutricion/api/consumo" method="POST">

        <!-- Selección de usuario -->
        <label for="usuario">Usuario:</label>
        <select id="usuario" name="id_usuario" required>
            <!-- Aquí se deben cargar los usuarios desde la base de datos -->
            <option value="1">Usuario 1</option>
            <option value="2">Usuario 2</option>
            <option value="3">Usuario 3</option>
        </select>
        <br><br>

        <!-- Selección de producto -->
        <label for="producto">Producto:</label>
        <select id="producto" name="nombre_producto" required>
            <!-- Aquí se deben cargar los productos desde la base de datos -->
            <option value="1">Producto A</option>
            <option value="2">Producto B</option>
            <option value="3">Producto C</option>
        </select>
        <br><br>

        <!-- Campo de cantidad -->
        <label for="cantidad">Cantidad:</label>
        <input type="number" id="cantidad" name="cantidad" min="1" required>
        <br><br>

        <!-- Campo de fecha de consumo -->
        <label for="fecha_consumo">Fecha de Consumo:</label>
        <input type="date" id="fecha_consumo" name="fecha_consumo" required>
        <br><br>

        <button type="submit">Registrar Consumo</button>
        
    </form>
<script>
     function updateNav() {
            fetch('/navbar-fragment')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('navbar-container').innerHTML = html;

                    const isAuthenticated = !!auth.obtenerToken() && auth.estaAutenticado();
                    // Mostrar/ocultar enlaces
                    document.querySelectorAll('.auth-only').forEach(el => {
                        el.style.display = isAuthenticated ? '' : 'none';
                    });
                    document.querySelectorAll('.guest-only').forEach(el => {
                        el.style.display = isAuthenticated ? 'none' : '';
                    });
                })
                .catch(error => console.error('Error al cargar el navbar:', error));
        }
        // Llamada inicial para actualizar el navbar cuando se carga la página
        window.addEventListener('DOMContentLoaded', updateNav);
</script>
</body>
</html>
